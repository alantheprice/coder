# Project Context: coder

## Overview
This is a command-line coding assistant written in Go that uses OpenAI's gpt-oss-120b model (via DeepInfra) or local gpt-oss:20b (via Ollama). The agent operates autonomously with core tools and follows systematic exploration patterns.

## Project Structure
- **main.go**: CLI interface with dual-mode support (local/remote)
- **agent/agent.go**: Core agent logic with embedded system prompt and tool execution
- **api/**: Unified client interface supporting both DeepInfra and Ollama
- **tools/**: Essential coding tools (shell, read, write, edit, todo management)
- **commands/**: Interactive slash command system

## Key Features
- Autonomous operation with systematic workflow
- Dual-mode support (cloud DeepInfra + local Ollama)
- Interactive mode with slash commands (/help, /models, /init)
- Tool integration for shell, file operations, and task management
- Context management with conversation history tracking
- Multi-model support across different providers

## Development Commands
- Build: go build -o coder .
- Run interactively: ./coder
- Run with query: ./coder "your query"
- Local inference: ./coder --local "your query"
- Testing: ./validate.sh, ./test_e2e.sh, ./test.sh

## Environment Setup
- Remote: export DEEPINFRA_API_KEY="your_api_key"
- Local: ollama pull gpt-oss:20b
- Debug: export DEBUG=true

## Model Configuration
- Remote: openai/gpt-oss-120b via DeepInfra (pay per use)
- Local: gpt-oss:20b via Ollama (free, requires 14GB VRAM)
- System Prompt: v2_structured (systematically tested and optimized)

## Tool Usage Patterns
The agent uses tools systematically:
1. **Shell commands** for exploration (ls, find, grep, go build, go test)
2. **Read file** to understand existing code structure
3. **Write/Edit file** to implement changes
4. **Todo tools** for complex task tracking
5. **Ask user** for clarification when requirements are ambiguous

## Architecture Notes
- Uses Go 1.24 with minimal dependencies (only readline)
- Harmony message formatting for gpt-oss model compatibility
- Conversation history tracking for cost analysis
- Comprehensive test suite with prompt engineering evaluation
- Performance metrics tracking across different system prompts

## Error Handling
- Tool execution errors are captured and reported
- API failures include retry logic
- Malformed tool calls are detected and corrected
- Connection checks validate client setup

## Interactive Commands
- /help - Show available commands
- /models - List available models
- /models select - Interactive model picker
- /init - Generate or regenerate project context
- exit - End session

## Development Guidelines
- Follow systematic exploration patterns
- Use tools efficiently and minimize unnecessary exploration
- Test changes thoroughly before completing tasks
- Maintain conversation continuity across sessions
- Track costs and token usage for optimization

## Go Module Info
module github.com/alantheprice/coder

go 1.24.0

toolchain go1.24.4

require (
	github.com/chzyer/readline v1.5.1 // indirect
	golang.org/x/sys v0.36.0 // indirect
	golang.org/x/term v0.35.0 // indirect
)


## Generated
Context generated on 2025-09-09 17:14:17 UTC by /init command
